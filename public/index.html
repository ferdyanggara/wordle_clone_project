<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet"/>
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
  />
</head>
<body>
    <h1> Wordle Clone </h1>
    
    <div id="test">
        <div>
            <input type="text" id="name"/>
            <button id="name-submit">Submit name</button>
        </div>
        <div>
            <input type="text" id="game"/>
            <button id="game-submit">Submit game</button>
        </div>
        <div>
            <input type="text" id="start"/>
            <button id="start-submit">start game</button>
        </div>
        <div>
            <button id="full-setup">Setup</button>"            
        </div>
        <div>
            <input type="text" id="word"/>
            <button id="submit-words">Words</button>
        </div>
    </div> 
    
    <div id="game-board">

    </div>

    <div id="keyboard-cont">
        <div class="first-row">
            <button class="keyboard-button">q</button>
            <button class="keyboard-button">w</button>
            <button class="keyboard-button">e</button>
            <button class="keyboard-button">r</button>
            <button class="keyboard-button">t</button>
            <button class="keyboard-button">y</button>
            <button class="keyboard-button">u</button>
            <button class="keyboard-button">i</button>
            <button class="keyboard-button">o</button>
            <button class="keyboard-button">p</button>
        </div>
        <div class="second-row">
            <button class="keyboard-button">a</button>
            <button class="keyboard-button">s</button>
            <button class="keyboard-button">d</button>
            <button class="keyboard-button">f</button>
            <button class="keyboard-button">g</button>
            <button class="keyboard-button">h</button>
            <button class="keyboard-button">j</button>
            <button class="keyboard-button">k</button>
            <button class="keyboard-button">l</button>
        </div>
        <div class="third-row">
            <button class="keyboard-button">Del</button>
            <button class="keyboard-button">z</button>
            <button class="keyboard-button">x</button>
            <button class="keyboard-button">c</button>
            <button class="keyboard-button">v</button>
            <button class="keyboard-button">b</button>
            <button class="keyboard-button">n</button>
            <button class="keyboard-button">m</button>
            <button class="keyboard-button">Enter</button>
        </div>
    </div>

<script
src="https://code.jquery.com/jquery-3.6.0.min.js"
integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="/socket.io/socket.io.min.js"></script>
<script src="./scripts/logic.js" type="module"></script>
<script>
    $(document).ready(function (){
        let currentName;
        let currentGameId;
        let socket;

        const setupSocket = (socket) => {
            socket.on('word-result', (value) => {
                console.log(value)
                console.log(JSON.parse(value));
            })
        }

        $('#name-submit').click( (e) => {
            e.preventDefault();
            console.log("name submit")
            fetch("/addData", {
            method : "POST",
            headers: {
                'Content-Type': 'application/json'
              },
            body : JSON.stringify({
                name : $('#name').val()
            })//just name now
            })
            .then( res => {
                console.log("name sent")
                setupSocket(socket)
                socket = io();
            })
        })

        $('#game-submit').click( (e) => {
            e.preventDefault();
            console.log("game submit")
            fetch("/createGame", {
            method : "POST",
            headers: {
                'Content-Type': 'application/json'
              },
            body :  JSON.stringify({
                name : $('#name').val(),
                gameId : $('#game').val()
            })
            })
            .then( res => res.json())
            .then( value => {
                console.log(value);
            })
        })

        $('#start-submit').click( (e) => {
            e.preventDefault();
            console.log("start submit")
            fetch("/startGame", {
            method : "POST",
            headers: {
                'Content-Type': 'application/json'
              },
            body :  JSON.stringify({
                gameId : $('#start').val()
            })
            })
            .then( value => {
                console.log(value);
            })
        })

        $("#full-setup").click( (e) => {
            e.preventDefault()
            currentName = "steven"
            currentGameId = "12"

            console.log("name submit")
            fetch("/addData", {
            method : "POST",
            headers: {
                'Content-Type': 'application/json'
              },
            body : JSON.stringify({
                name : currentName
            })//just name now
            })
            .then( res => {
                socket = io();
                setupSocket(socket)
                fetch("/createGame", {
                    method : "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body :  JSON.stringify({
                        name : currentName,
                        gameId : currentGameId
                    })
                    })
                    .then( res => res.json())
                    .then( value => {
                        console.log(value);
                })
                .then(res => {
                    console.log("start submit")
                    fetch("/startGame", {
                    method : "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body :  JSON.stringify({
                        gameId : currentGameId
                    })
                    })
                    .then( value => {
                        console.log(value);
                    })
                })              
            })

        })

        $("#submit-words").click( e => {
            e.preventDefault()
            console.log("words clicked")
            console.log($("#word").val())
            socket.emit("word-sent", $("#word").val());
        })



    });
</script>
</body>
</html>